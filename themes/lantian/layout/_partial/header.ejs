<header class="lantian navbar navbar-expand-lg">
    <a class="navbar-brand" href="<%- (function() {
        if(is_default_language(page_language())) {
            return url_for(config.root);
        } else {
            return url_for(config.root + (config.root == '/' ? '' : '/') + page_language());
        }
    })(); %>"><%= config.title %></a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#lantian-navbar" aria-controls="lantian-navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="lantian-navbar">
        <ul class="navbar-nav nav-pills navbar-spacer">
            <% if(theme_config(page_language()).nav) { %>
                <% theme_config(page_language()).nav.forEach(function(link) { %>
                    <li class="nav-item d-none d-md-block">
                        <a class="nav-link<% if(link.url == '/' + page.path) { %> active<% } %>" href="<%- url_for(remove_trailing_slash(link.url)) %>"><%- link.name %></a>
                    </li>
                <% }) %>

                <li class="nav-item dropdown d-block d-md-none">
                    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                        <i class="fas fa-fw fa-file"></i> <%- __('page') %> <span class="caret"></span>
                    </a>
                    <div class="dropdown-menu">
                        <% theme_config(page_language()).nav.forEach(function(link) { %>
                            <a class="dropdown-item<% if(link.url == '/' + page.path) { %> active<% } %>" href="<%- url_for(remove_trailing_slash(link.url)) %>"><%- link.name %></a>
                        <% }) %>
                    </div>
                </li>
            <% } %>

            <% if(0 && site.categories && site.categories.length) { %>
            <li class="nav-item dropdown">
                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><%- __('category') %> <span class="caret"></span></a>
                <div class="dropdown-menu">
                    <% site.categories.sort('name', 'asc').each(function(category) { %>
                        <% if('' == category.name) return; %>
                        <a class="dropdown-item<%
                            if(is_post()) {
                                if(_.includes(page.categories.map(c => c.name), category.name)) {
                                    %> active<%
                                }
                            } else if(is_category()) {
                                if(page.category == category.name) {
                                    %> active<%
                                }
                            } %>" href="<%- url_for(remove_trailing_slash(category.path)) %>"><%- category.name %></a>
                    <% }) %>
                </div>
            </li>
            <% } %>

            <% const languages = display_languages(); %>
            <% if (languages.length > 1) { %>
            <li class="nav-item dropdown">
                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                    <i class="fas fa-fw fa-language"></i> <%- __('language') %> <span class="caret"></span>
                </a>
                <div class="dropdown-menu">
                    <% languages.forEach((language) => { %>
                        <a href="<%= url_for(remove_trailing_slash(i18n_path(!is_default_language(language) ? language : null))) %>" class="dropdown-item<% if(language == page.language) { %> active<% } %>">
                            <%- language_name(language) %>
                        </a>
                    <% }) %>
                    <div class="dropdown-divider"></div>
                    <a class="dropdown-item disabled" href="#">Not all pages have translations.</a>
                    <a class="dropdown-item disabled" href="#">You may see 404 - this is normal.</a>
                </div>
            </li>
            <% } %>
        </ul>
        <ul class="navbar-nav nav-pills">
            <li class="nav-item position-relative">
                <a class="nav-link" id="dark-mode" href="#">
                    <i class="fas fa-fw fa-adjust"></i> <%- __('color_scheme') %>
                </a>
            </li>
        </ul>
    </div>
</header>

<% if(theme_config(page_language()).announcement) { %>
<section class="text-center lantian">
    <%- theme_config(page_language()).announcement %>
</section>
<% } %>
